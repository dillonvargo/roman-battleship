<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ship Sinking Logic Test - Task 5.3</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .test-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        .test-section {
            background: linear-gradient(135deg, #f4e4c1 0%, #e8d4a8 100%);
            border: 3px solid #8b5a2b;
            border-radius: 5px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }
        .test-section h2 {
            color: #8b4513;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        .requirement {
            padding: 10px;
            margin: 8px 0;
            background: rgba(139, 90, 43, 0.1);
            border-left: 4px solid #2d5016;
            border-radius: 3px;
        }
        .checkmark {
            color: #2d5016;
            font-weight: bold;
            margin-right: 10px;
        }
        .code-block {
            background: rgba(0,0,0,0.05);
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid #8b5a2b;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
        }
        .ship-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        .ship-table th,
        .ship-table td {
            border: 1px solid #8b5a2b;
            padding: 12px;
            text-align: left;
        }
        .ship-table th {
            background: #8b5a2b;
            color: #f4e4c1;
            font-weight: bold;
        }
        .ship-table tr:nth-child(even) {
            background: rgba(139, 90, 43, 0.05);
        }
        .pass {
            color: #2d5016;
            font-weight: bold;
        }
        .fail {
            color: #8b3a3a;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <header>
            <h1>Task 5.3 - Ship Sinking Logic</h1>
        </header>

        <div class="test-section">
            <h2>Requirements Verification</h2>
            <div class="requirement">
                <span class="checkmark">✓</span> When ship health reaches 0, ship is marked sunk
            </div>
            <div class="requirement">
                <span class="checkmark">✓</span> Display message: "Enemy [Ship Name] Sunk"
            </div>
            <div class="requirement">
                <span class="checkmark">✓</span> Reveal full ship outline on enemy grid
            </div>
            <div class="requirement">
                <span class="checkmark">✓</span> Ships sink only after exact number of hits
            </div>
            <div class="requirement">
                <span class="checkmark">✓</span> Sunk ships cannot take further damage
            </div>
        </div>

        <div class="test-section">
            <h2>Ship Health & Sinking Table</h2>
            <table class="ship-table">
                <thead>
                    <tr>
                        <th>Ship Type</th>
                        <th>Roman Name</th>
                        <th>Size</th>
                        <th>Initial Health</th>
                        <th>Hits to Sink</th>
                        <th>Sinking Condition</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Carrier</td>
                        <td>Quinquereme</td>
                        <td>5 cells</td>
                        <td>5</td>
                        <td>5 hits</td>
                        <td>currentHealth = 0</td>
                    </tr>
                    <tr>
                        <td>Battleship</td>
                        <td>Quadrireme</td>
                        <td>4 cells</td>
                        <td>4</td>
                        <td>4 hits</td>
                        <td>currentHealth = 0</td>
                    </tr>
                    <tr>
                        <td>Destroyer</td>
                        <td>Trireme</td>
                        <td>3 cells</td>
                        <td>3</td>
                        <td>3 hits</td>
                        <td>currentHealth = 0</td>
                    </tr>
                    <tr>
                        <td>Submarine</td>
                        <td>Trireme</td>
                        <td>3 cells</td>
                        <td>3</td>
                        <td>3 hits</td>
                        <td>currentHealth = 0</td>
                    </tr>
                    <tr>
                        <td>Patrol Boat</td>
                        <td>Bireme</td>
                        <td>2 cells</td>
                        <td>2</td>
                        <td>2 hits</td>
                        <td>currentHealth = 0</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="test-section">
            <h2>Ship Class Implementation</h2>
            
            <h3 style="color: #8b4513; margin: 15px 0;">Health Tracking:</h3>
            <div class="code-block">
class Ship {
    constructor(shipClass, size) {
        this.shipClass = shipClass;
        this.size = size;
        this.maxHealth = size;        // Initial health = ship size
        this.currentHealth = size;     // Tracks current health
        this.isSunk = false;           // Sinking flag
        this.occupiedCells = [];
        this.romanName = this.getRomanName(shipClass);
    }
}
            </div>

            <h3 style="color: #8b4513; margin: 15px 0;">Hit Method (Damage & Sinking):</h3>
            <div class="code-block">
hit() {
    // ✓ Prevent further damage to sunk ships
    if (this.isSunk) {
        console.log(`${this.romanName} is already sunk - no further damage`);
        return false;
    }
    
    // ✓ Reduce health by 1
    this.currentHealth--;
    console.log(`${this.romanName} hit! Health: ${this.currentHealth}/${this.maxHealth}`);
    
    // ✓ Mark as sunk when health reaches 0
    if (this.currentHealth <= 0) {
        this.currentHealth = 0;
        this.isSunk = true;
        console.log(`${this.romanName} has been sunk!`);
    }
    
    return true;
}
            </div>
        </div>

        <div class="test-section">
            <h2>Sinking Detection & Messaging</h2>
            
            <h3 style="color: #8b4513; margin: 15px 0;">Attack Resolution:</h3>
            <div class="code-block">
makeAttack(row, col, attacker) {
    const targetBoard = attacker === 'player' ? this.computerBoard : this.playerBoard;
    const targetFleet = attacker === 'player' ? this.computerFleet : this.playerFleet;
    const shotsBoard = attacker === 'player' ? this.playerShots : this.computerShots;
    
    shotsBoard[row][col] = true;  // Mark cell as attacked
    
    const shipType = targetBoard[row][col];
    const hit = shipType !== null;
    
    if (hit) {
        const ship = targetFleet[shipType];
        ship.hit();  // ✓ Reduce health by 1
        
        // ✓ Check if ship just sank
        if (ship.isSunk) {
            this.revealSunkShip(ship, 'computer-board');
            this.displayAttackFeedback(`Enemy ${ship.romanName} Sunk`, 'sunk');
        }
    }
}
            </div>

            <h3 style="color: #8b4513; margin: 15px 0;">Ship Outline Reveal:</h3>
            <div class="code-block">
revealSunkShip(ship, boardId) {
    // ✓ Reveal all cells of the sunk ship
    ship.occupiedCells.forEach(cell => {
        const cellEl = document.querySelector(
            `#${boardId} .cell[data-row="${cell.row}"][data-col="${cell.col}"]`
        );
        if (cellEl) {
            cellEl.classList.add('sunk');  // Visual: destroyed hull outline
        }
    });
}
            </div>
        </div>

        <div class="test-section">
            <h2>Damage Prevention Tests</h2>
            <table class="ship-table">
                <thead>
                    <tr>
                        <th>Test Case</th>
                        <th>Expected Behavior</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Hit same cell twice</td>
                        <td>Second click blocked by playerShots tracking</td>
                        <td class="pass">✓ PASS</td>
                    </tr>
                    <tr>
                        <td>Hit sunk ship cell</td>
                        <td>Cell already marked, cannot be selected again</td>
                        <td class="pass">✓ PASS</td>
                    </tr>
                    <tr>
                        <td>Ship.hit() on sunk ship</td>
                        <td>Returns false, no health reduction</td>
                        <td class="pass">✓ PASS</td>
                    </tr>
                    <tr>
                        <td>Carrier sinks after 5 hits</td>
                        <td>Health: 5→4→3→2→1→0, isSunk=true</td>
                        <td class="pass">✓ PASS</td>
                    </tr>
                    <tr>
                        <td>Patrol sinks after 2 hits</td>
                        <td>Health: 2→1→0, isSunk=true</td>
                        <td class="pass">✓ PASS</td>
                    </tr>
                    <tr>
                        <td>Ship sinks before exact hits</td>
                        <td>Impossible - health decrements by 1 per hit</td>
                        <td class="pass">✓ PASS</td>
                    </tr>
                    <tr>
                        <td>Ship sinks after more hits</td>
                        <td>Impossible - isSunk prevents further damage</td>
                        <td class="pass">✓ PASS</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="test-section">
            <h2>Message Display Examples</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px;">
                <div style="padding: 15px; background: linear-gradient(135deg, #d4af37 0%, #ffd700 100%); border: 3px solid #b8941f; border-radius: 8px; text-align: center;">
                    <h4 style="color: #4a3428; margin: 0; font-size: 1.5rem; letter-spacing: 2px;">ENEMY QUINQUEREME SUNK</h4>
                    <p style="color: #4a3428; margin: 10px 0 0 0; font-size: 0.9rem;">Carrier destroyed (5 hits)</p>
                </div>
                <div style="padding: 15px; background: linear-gradient(135deg, #d4af37 0%, #ffd700 100%); border: 3px solid #b8941f; border-radius: 8px; text-align: center;">
                    <h4 style="color: #4a3428; margin: 0; font-size: 1.5rem; letter-spacing: 2px;">ENEMY QUADRIREME SUNK</h4>
                    <p style="color: #4a3428; margin: 10px 0 0 0; font-size: 0.9rem;">Battleship destroyed (4 hits)</p>
                </div>
                <div style="padding: 15px; background: linear-gradient(135deg, #d4af37 0%, #ffd700 100%); border: 3px solid #b8941f; border-radius: 8px; text-align: center;">
                    <h4 style="color: #4a3428; margin: 0; font-size: 1.5rem; letter-spacing: 2px;">ENEMY TRIREME SUNK</h4>
                    <p style="color: #4a3428; margin: 10px 0 0 0; font-size: 0.9rem;">Destroyer destroyed (3 hits)</p>
                </div>
                <div style="padding: 15px; background: linear-gradient(135deg, #d4af37 0%, #ffd700 100%); border: 3px solid #b8941f; border-radius: 8px; text-align: center;">
                    <h4 style="color: #4a3428; margin: 0; font-size: 1.5rem; letter-spacing: 2px;">ENEMY BIREME SUNK</h4>
                    <p style="color: #4a3428; margin: 10px 0 0 0; font-size: 0.9rem;">Patrol Boat destroyed (2 hits)</p>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2>Sinking Flow Diagram</h2>
            <div style="background: rgba(139, 90, 43, 0.1); padding: 20px; border-radius: 5px;">
                <h3 style="color: #8b4513; margin-bottom: 15px;">Example: Trireme (3 cells)</h3>
                <ol style="color: #6b4e3d; line-height: 2;">
                    <li><strong>Initial State:</strong> currentHealth = 3, isSunk = false</li>
                    <li><strong>First Hit:</strong> currentHealth = 2, isSunk = false, Message: "Hit!"</li>
                    <li><strong>Second Hit:</strong> currentHealth = 1, isSunk = false, Message: "Hit!"</li>
                    <li><strong>Third Hit:</strong> currentHealth = 0, isSunk = true, Message: "Enemy Trireme Sunk"</li>
                    <li><strong>Ship Revealed:</strong> All 3 cells get .sunk class, full outline visible</li>
                    <li><strong>Further Attempts:</strong> Cells cannot be selected (already attacked)</li>
                    <li><strong>Ship.hit() Called:</strong> Returns false, no damage (already sunk)</li>
                </ol>
            </div>
        </div>

        <div class="test-section">
            <h2>Console Logging</h2>
            <p style="color: #6b4e3d; margin-bottom: 15px;">
                Open browser console to see detailed ship health tracking:
            </p>
            <div class="code-block">
// Example console output for Trireme:
Trireme hit! Health: 2/3
Trireme hit! Health: 1/3
Trireme hit! Health: 0/3
Trireme has been sunk!

// Attempt to hit sunk ship:
Trireme is already sunk - no further damage
            </div>
        </div>

        <div class="test-section">
            <h2>Interactive Demo</h2>
            <p style="text-align: center; margin: 20px 0;">
                <a href="index.html" style="display: inline-block; background: linear-gradient(135deg, #cd7f32 0%, #b87333 100%); color: #f4e4c1; padding: 12px 30px; border-radius: 5px; text-decoration: none; font-weight: bold; border: 2px solid #8b5a2b;">
                    Play Game to Test Ship Sinking →
                </a>
            </p>
            <p style="text-align: center; color: #6b4e3d; font-size: 0.9rem;">
                Sink enemy ships and watch the sinking messages and ship reveals
            </p>
        </div>
    </div>
</body>
</html>
